---
- include: setup-RedHat.yml
  when: ansible_os_family == 'RedHat'

- include: setup-Debian.yml
  when: ansible_os_family == 'Debian'

- block:
    - name: Install Filebeat in Linux.
      package:
        name: "{{ filebeat_package }}"
        state: "{{ filebeat_package_state }}"

    - include: config.yml
      when: filebeat_create_config | bool

    - name: Ensure Filebeat is started and enabled at boot.
      service:
        name: filebeat
        state: started
        enabled: true
  when: ansible_os_family != 'Windows'

- include: windows.yml
  when: ansible_os_family == 'Windows'
